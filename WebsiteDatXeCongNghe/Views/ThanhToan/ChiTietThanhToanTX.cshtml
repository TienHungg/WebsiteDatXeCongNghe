﻿@model WebsiteDatXeCongNghe.ViewModel.MultipleData.MultipleData
@{
    ViewBag.Title = "ChiTietThanhToanTX";
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hóa đơn chuyến đi</title>

    <!-- Invoice styling -->
    <style>
        body {
            font-family: 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
            text-align: center;
            color: #777;
        }

            body h1 {
                font-weight: 300;
                margin-bottom: 0px;
                padding-bottom: 0px;
                color: #000;
            }

            body h3 {
                font-weight: 300;
                margin-top: 10px;
                margin-bottom: 20px;
                font-style: italic;
                color: #555;
            }

            body a {
                color: #06f;
            }

        .invoice-box {
            max-width: 800px;
            margin: auto;
            padding: 30px;
            border: 1px solid #eee;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);
            font-size: 16px;
            line-height: 24px;
            font-family: 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
            color: #555;
        }

            .invoice-box table {
                width: 100%;
                line-height: inherit;
                text-align: left;
                border-collapse: collapse;
            }

                .invoice-box table td {
                    padding: 5px;
                    vertical-align: top;
                }

                .invoice-box table tr td:nth-child(2) {
                    text-align: right;
                }

                .invoice-box table tr.top table td {
                    padding-bottom: 20px;
                }

                    .invoice-box table tr.top table td.title {
                        font-size: 45px;
                        line-height: 45px;
                        color: #333;
                    }

                .invoice-box table tr.information table td {
                    padding-bottom: 40px;
                }

                .invoice-box table tr.heading td {
                    background: #eee;
                    border-bottom: 1px solid #ddd;
                    font-weight: bold;
                }

                .invoice-box table tr.details td {
                    padding-bottom: 20px;
                }

                .invoice-box table tr.item td {
                    border-bottom: 2px solid #eee;
                }

                .invoice-box table tr.item.last td {
                    border-bottom: none;
                }

                .invoice-box table tr.total td:nth-child(2) {
                    border-top: 2px solid #eee;
                    font-weight: bold;
                }

            .red-asterisk::after {
                content: '*';
                color: red; /* Set the color for the asterisk */
            }
    </style>
</head>

<body>


    <div class="invoice-box">
        <h1>HÓA ĐƠN CHUYẾN XE TÀI XẾ</h1>
        <table>
            <tr class="top">
                <td colspan="2">
                    <table>
                        <tr>
                            <td class="title">
                                <img src="~/image/ThanhToan/car-booking-service-4975058-4144419.png" alt="Company logo" style="width: 100%; max-width: 300px" />
                            </td>
                            @foreach (var item in Model.thanhToans)
                            {
                                <td>
                                    Số hóa đơn: @item.MaThanhToan<br />
                                    Ngày giờ tạo: @item.NgayThanhToan<br />
                                    Trạng thái hóa đơn: @{
                                        if (item.TrangThai)
                                        {
                                            <text>Hoàn thành</text>
                                        }
                                        else
                                        {
                                            <text>Chưa hoàn thành</text>
                                        }
                                    }<br />
                                </td>
                            }
                        </tr>
                    </table>
                </td>
            </tr>

            <tr class="information">
                <td colspan="2">
                    <table>
                        <tr>
                            @foreach (var item in Model.thanhToans)
                            {
                                <td>
                                    Đặt chuyến đi.<br />
                                    Dịch vụ chở khách.<br />
                                    Số điện thoại: @item.SoDienThoaiTX<br />
                                </td>
                            }

                        </tr>
                    </table>
                </td>
            </tr>

            <tr class="heading">
                <td>Phương thức thanh toán</td>
                @foreach (var item in Model.thanhToans)
                {
                    <td>@item.HinhThucThanhToan</td>
                }
            </tr>
            <tr class="item">
                <td></td>
                <td></td>
            </tr>
            <tr class="heading">
                <td>Thông tin chuyến đi</td>

                <td>Chi tiết</td>
            </tr>
            @foreach (var item in Model.thongTinDatXes)
            {
                <tr class="item">
                    <td>Điểm đón</td>

                    <td>@item.DiemDon</td>
                </tr>
                <tr class="item">
                    <td>Điểm đến</td>

                    <td>@item.DiemDen</td>
                </tr>

                <tr class="item">
                    <td>Quãng đường</td>

                    <td>@item.SoKm</td>
                </tr>

                <tr class="item">
                    <td>Thời gian</td>

                    <td>@item.ThoiGian</td>
                </tr>

                <tr class="item">
                    <td>Loại xe</td>

                    <td>@item.LoaiXe</td>
                </tr>

                <tr class="item">
                    <td>Ngày giờ đặt</td>

                    <td>@item.NgayGioDat</td>
                </tr>

                <tr class="item">
                    <td>Trạng thái chuyến xe</td>

                    <td>
                        @{
                            if (item.TrangThai)
                            {
                                <text>Hoàn thành</text>
                            }
                            else
                            {
                                <text>Chưa hoàn thành</text>
                            }
                        }
                    </td>
                </tr>
            }
            <tr class="heading">
                <td>Dịch vụ</td>

                <td>Giá</td>
            </tr>
            @foreach (var item in Model.thanhToans)
            {
                <tr class="item">
                    <td>Phương thức</td>

                    <td>@item.HinhThucThanhToan</td>
                </tr>
                <tr class="item">
                    <td>Giá ban đầu</td>

                    <td>@item.GiaBanDau</td>
                </tr>

                <tr class="item">
                    <td>Phí mở rộng khoảng cách tìm tài xế (5km)</td>

                    <td>
                        @{
                            if (item.PhiMoRong != null && item.PhiMoRong != 0)
                            {
                                <text>@item.PhiMoRong</text>
                            }
                            else
                            {
                                <text>Không áp dụng</text>
                            }
                        }
                    </td>
                </tr>

                <tr class="item">
                    <td>Phí cầu đường</td>

                    <td>
                        @{
                            if (item.PhiCauDuong != null && item.PhiCauDuong != 0)
                            {
                                <text>@item.PhiCauDuong</text>
                            }
                            else
                            {
                                <text>Không áp dụng</text>
                            }
                        }
                    </td>
                </tr>

                <tr class="item">
                    <td>Khuyến mãi</td>

                    <td>
                        @{
                            if (item.PhiKhuyenMai != null && item.PhiKhuyenMai != 0)
                            {
                                <text>@item.PhiKhuyenMai</text>
                            }
                            else
                            {
                                <text>Không áp dụng</text>
                            }
                        }
                    </td>
                </tr>

                <tr class="item">
                    <td>Thành tiền</td>

                    <td>@item.TongTien</td>
                </tr>

                <tr class="item">
                    <td class="red-asterisk">Phí ứng dụng, thuế</td>

                    <td>
                        @{
                            decimal discountAmount2 = item.TongTien ?? 0m; // Ensure TongTien is not null
                            discountAmount2 *= 0.3m; // Multiply by a decimal value
                            discountAmount2 = Math.Round(discountAmount2, 3); // Round to three decimal places
                            <text>@(-discountAmount2) (30% hóa đơn)</text>
                        }
                    </td>
                </tr>

                <tr class="item">
                    <td>Thực nhận</td>

                    <td>
                        @{
                            decimal receivedAmount2 = item.TongTien ?? 0m; // Ensure TongTien is not null
                            receivedAmount2 *= 0.7m; // Multiply by a decimal value
                            receivedAmount2 = Math.Round(receivedAmount2, 3); // Round to three decimal places
                            @receivedAmount2
                        }
                    </td>
                </tr>

                <tr class="item last">
                    <td>Ví tiền</td>
                    <td>
                        @{
                            if (item.HinhThucThanhToan == "Tiền mặt")
                            {
                                decimal discountAmount = item.TongTien ?? 0m; // Ensure TongTien is not null
                                discountAmount *= 0.3m; // Multiply by a decimal value
                                discountAmount = Math.Round(discountAmount, 3); // Round to three decimal places
                                <text>@(-discountAmount) (30% hóa đơn)</text>
                            }
                            else if (item.HinhThucThanhToan == "Qua thẻ")
                            {
                                decimal additionalAmount = item.TongTien ?? 0m; // Ensure TongTien is not null
                                additionalAmount *= 0.7m; // Multiply by a decimal value
                                additionalAmount = Math.Round(additionalAmount, 3); // Round to three decimal places
                                <text>+@(additionalAmount) (70% hóa đơn)</text>
                            }
                            else
                            {
                                <text>Không áp dụng</text>
                            }
                        }
                    </td>
                </tr>

                <tr class="total">
                    <td></td>
                    <td>
                        Thực nhận: @{
                            decimal receivedAmount = item.TongTien ?? 0m; // Ensure TongTien is not null
                            receivedAmount *= 0.7m; // Multiply by a decimal value
                            receivedAmount = Math.Round(receivedAmount, 3); // Round to three decimal places
                            @receivedAmount
                        }
                    </td>
                </tr>

            }
        </table>
    </div>
</body>
</html>

